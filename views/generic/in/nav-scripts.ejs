<script>
    var setImage = function(){
        var currency = $.cookie('currency-display');
        if (currency == "usd"){
            $("#Currency-Dropdown-Image").attr("src", "/assets/flags/us.png");
        }  
        else if (currency == "eu"){
            $("#Currency-Dropdown-Image").attr("src", "/assets/flags/eu.png");
        }  
        else if (currency == "uk"){
            $("#Currency-Dropdown-Image").attr("src", "/assets/flags/uk.png");
        }  
        else if (currency == "jp"){
            $("#Currency-Dropdown-Image").attr("src", "/assets/flags/jp.png");
        }  
        else if (currency == "ch"){
            $("#Currency-Dropdown-Image").attr("src", "/assets/flags/cn.png");
        }  
        else{
            $("#Currency-Dropdown-Image").attr("src", "/assets/flags/single-poker-chip.png");
        }
    }
    setImage();
    var showWarning = function(){
        console.log("Showing warning");
        var message = "<b>NOTE:</b> Currency conversions are provided as a convenience. Rates are updated every hour at the latest, but should not be taken as an exact representation.\n\nWe recommend using BTC or Satoshis as that is the true representation of the value.";
        var dialog = BootstrapDialog.show({
            message: message,
            title: "Note",
            buttons: [{
                label: 'Confirm',
                cssClass: 'btn btn-lg btn-success',
                action: function(){
                    dialog.close();
                    location.reload();
                }
            }]
        });
    }
    var setCurrency = function(name){
        console.log("SHOWING WARNING");
        $.cookie('currency-display', name,{ path: '/', expires: 30});
    }
    $("#CA-select").click(function(e){
        e.preventDefault();
        setCurrency("ca");
        showWarning();
    });
    $("#EU-select").click(function(e){
        console.log("SETTNIG EU");
        e.preventDefault();
        setCurrency("eu");
        showWarning();
    });
    $("#UK-select").click(function(e){
        e.preventDefault();
        setCurrency("uk");
        showWarning();
    });
    $("#AU-select").click(function(e){
        e.preventDefault();
        setCurrency("au");
        showWarning();
    });
    $("#MX-select").click(function(e){
        e.preventDefault();
        setCurrency("mx");
        showWarning();
    });
    $("#BR-select").click(function(e){
        e.preventDefault();
        setCurrency("br");
        showWarning();
    });
    $("#AR-select").click(function(e){
        e.preventDefault();
        setCurrency("ar");
        showWarning();
    });
    $("#JP-select").click(function(e){
        e.preventDefault();
        setCurrency("jp");
        showWarning();
    });
    $("#CH-select").click(function(e){
        e.preventDefault();
        setCurrency("ch");
        showWarning();
    });
    $("#USD-select").click(function(e){
        e.preventDefault();
        setCurrency("usd");
        showWarning();
    });
    $("#BTC-select").click(function(e){
        e.preventDefault();
        setCurrency("bitcoin");
        location.reload();
    });
    $("#SATOSHI-select").click(function(e){
        e.preventDefault();
        setCurrency("satoshi");
        location.reload();
    });
  $(document).ready(function(){
    $("body").find(".currency").each(function () {
      //  parsing satoshis
      var val = parseInt($(this).html());
      val = currencyOutput(val);
      $(this).html(val);
    });
    $("body").find(".denomination").each(function () {
      //  parsing satoshis
      $(this).html(currencyName());
    });
    $("body").find(".date").each(function () {
      //  parsing satoshis
      $(this).html((new Date($(this).html())).toDateString());
    });
    $("body").find(".time").each(function () {
      //  parsing satoshis
      $(this).html((new Date($(this).html())).toLocaleString());
    });
    

    document.getElementById("main").style.display = 'block';
    //Convert all -1 to n/a
    /*$("#track-table").find("td:nth-child(7)").each(function () {
      var val = parseInt($(this).html());
      if (val < 0 ) {
        $(this).html("n/a");
      }
    });*/
  });
</script>
